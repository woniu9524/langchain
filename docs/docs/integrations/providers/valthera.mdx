# Valthera

> [Valthera](https://github.com/valthera/valthera) 是一个开源框架，旨在赋能 LLM Agent，驱动有意义、有上下文感知能力的用户互动。它实时评估用户的动机和能力，确保仅在用户最易接受时触发通知和操作。
>
> **langchain-valthera** 将 Valthera 与 LangChain 集成，使开发者能够构建更智能、由行为驱动的互动系统，提供个性化体验。

## 安装与设置

### 安装 langchain-valthera

通过 pip 安装 LangChain Valthera 包：

```bash
pip install -U langchain-valthera
```

导入 ValtheraTool：

```python
from langchain_valthera.tools import ValtheraTool
```

### 示例：为 LangChain 初始化 ValtheraTool

此示例展示了如何使用 `DataAggregator` 和动机（motivation）及能力（ability）评分的配置来初始化 ValtheraTool。

```python
import os
from langchain_openai import ChatOpenAI
from valthera.aggregator import DataAggregator
from mocks import hubspot, posthog, snowflake  # 用您实际的连接器实现替换这些
from langchain_valthera.tools import ValtheraTool

# 使用您的数据连接器初始化 DataAggregator
data_aggregator = DataAggregator(
    connectors={
        "hubspot": hubspot(),
        "posthog": posthog(),
        "app_db": snowflake()
    }
)

# 使用您的评分配置初始化 ValtheraTool
valthera_tool = ValtheraTool(
    data_aggregator=data_aggregator,
    motivation_config=[
        {"key": "hubspot_lead_score", "weight": 0.30, "transform": lambda x: min(x, 100) / 100.0},
        {"key": "posthog_events_count_past_30days", "weight": 0.30, "transform": lambda x: min(x, 50) / 50.0},
        {"key": "hubspot_marketing_emails_opened", "weight": 0.20, "transform": lambda x: min(x / 10.0, 1.0)},
        {"key": "posthog_session_count", "weight": 0.20, "transform": lambda x: min(x / 5.0, 1.0)}
    ],
    ability_config=[
        {"key": "posthog_onboarding_steps_completed", "weight": 0.30, "transform": lambda x: min(x / 5.0, 1.0)},
        {"key": "posthog_session_count", "weight": 0.30, "transform": lambda x: min(x / 10.0, 1.0)},
        {"key": "behavior_complexity", "weight": 0.40, "transform": lambda x: 1 - (min(x, 5) / 5.0)}
    ]
)

print("✅ ValtheraTool 已成功初始化以进行 LangChain 集成！")
```

langchain-valthera 集成允许您评估用户行为，并决定最佳的互动策略，确保在您的 LangChain 应用中实现的互动既及时又相关。